// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Chain {
  id   Int    @id @unique
  name String

  Block           Block[]
  Token           Token[]
  AccountActivity AccountActivity[]
}

model Block {
  id Int @id @unique @default(autoincrement())

  number    Int
  hash      String
  timestamp DateTime

  chain   Chain @relation(fields: [chainId], references: [id])
  chainId Int

  accountActivitiesByFromBlock AccountActivity[] @relation("fromBlockActivities")
  accountActivitiesByToBlock   AccountActivity[] @relation("toBlockActivities")
}

model Token {
  id Int @id @unique @default(autoincrement())

  address  String
  symbol   String
  decimals Int

  chain   Chain @relation(fields: [chainId], references: [id])
  chainId Int

  token0 AccountActivity[] @relation("token0")
  token1 AccountActivity[] @relation("token1")
}

model Account {
  address String @id @unique

  AccountActivity AccountActivity[]
}

model AccountActivity {
  id Int @id @unique @default(autoincrement())

  fromBlock   Block @relation("fromBlockActivities", fields: [fromBlockId], references: [id])
  fromBlockId Int

  toBlock   Block @relation("toBlockActivities", fields: [toBlockId], references: [id])
  toBlockId Int

  token0   Token @relation("token0", fields: [token0Id], references: [id])
  token0Id Int

  token1   Token @relation("token1", fields: [token1Id], references: [id])
  token1Id Int

  sent0     String
  received0 String

  totalSent0     String
  totalReceived0 String

  sent1     String
  received1 String

  totalSent1     String
  totalReceived1 String

  chain   Chain @relation(fields: [chainId], references: [id])
  chainId Int

  account   Account @relation(fields: [accountId], references: [address])
  accountId String

  asMaker Boolean
}
